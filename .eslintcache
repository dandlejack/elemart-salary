[{"D:\\Work\\elemart-salary\\src\\index.tsx":"1","D:\\Work\\elemart-salary\\src\\reportWebVitals.ts":"2","D:\\Work\\elemart-salary\\src\\App.tsx":"3","D:\\Work\\elemart-salary\\src\\utils\\RouterPath.ts":"4","D:\\Work\\elemart-salary\\src\\components\\SiderComponent.tsx":"5","D:\\Work\\elemart-salary\\src\\pages\\EmployeePage\\EmployeePage.tsx":"6","D:\\Work\\elemart-salary\\src\\pages\\DashboardPage\\DashboardPage.tsx":"7","D:\\Work\\elemart-salary\\src\\pages\\SalaryListPage\\SaralyListPage.tsx":"8","D:\\Work\\elemart-salary\\src\\components\\HeaderComponent.tsx":"9","D:\\Work\\elemart-salary\\src\\components\\AddEmployeeForm\\AddEmployeeForm.tsx":"10","D:\\Work\\elemart-salary\\src\\components\\CustomModal\\CustomModal.tsx":"11","D:\\Work\\elemart-salary\\src\\api\\EmployeeApi.ts":"12","D:\\Work\\elemart-salary\\src\\config.ts":"13","D:\\Work\\elemart-salary\\src\\mockData\\mockColumnTable.tsx":"14","D:\\Work\\elemart-salary\\src\\pages\\EmployeeInfo\\EmployeeInfoPage.tsx":"15","D:\\Work\\elemart-salary\\src\\components\\AddSalaryForm\\AddSalaryForm.tsx":"16","D:\\Work\\elemart-salary\\src\\components\\EditTable\\EditableTable.tsx":"17","D:\\Work\\elemart-salary\\src\\components\\EditTable\\EditableCell.tsx":"18","D:\\Work\\elemart-salary\\src\\api\\ReportApi.ts":"19","D:\\Work\\elemart-salary\\src\\utils\\AddComma.ts":"20","D:\\Work\\elemart-salary\\src\\pages\\SalaryListInfoPage\\SalaryInfoPage.tsx":"21","D:\\Work\\elemart-salary\\src\\components\\generatePDF\\generatePDF.tsx":"22","D:\\Work\\elemart-salary\\src\\components\\GeneratePDF\\GeneratePDF.tsx":"23","D:\\Work\\elemart-salary\\src\\components\\Excel\\ExcelComponent.tsx":"24","D:\\Work\\elemart-salary\\src\\pages\\SettingPage\\SettingPage.tsx":"25"},{"size":638,"mtime":1620526783345,"results":"26","hashOfConfig":"27"},{"size":425,"mtime":499162500000,"results":"28","hashOfConfig":"27"},{"size":946,"mtime":1621237066584,"results":"29","hashOfConfig":"27"},{"size":1391,"mtime":1621394623972,"results":"30","hashOfConfig":"27"},{"size":1309,"mtime":1620481734344,"results":"31","hashOfConfig":"27"},{"size":1028,"mtime":1621237117181,"results":"32","hashOfConfig":"27"},{"size":228,"mtime":1620204122698,"results":"33","hashOfConfig":"27"},{"size":989,"mtime":1621237101646,"results":"34","hashOfConfig":"27"},{"size":975,"mtime":1621237078098,"results":"35","hashOfConfig":"27"},{"size":1692,"mtime":1621222490128,"results":"36","hashOfConfig":"27"},{"size":388,"mtime":1620561632103,"results":"37","hashOfConfig":"27"},{"size":1359,"mtime":1621320710216,"results":"38","hashOfConfig":"27"},{"size":224,"mtime":1621395842284,"results":"39","hashOfConfig":"27"},{"size":5707,"mtime":1621391999187,"results":"40","hashOfConfig":"27"},{"size":12965,"mtime":1622170082923,"results":"41","hashOfConfig":"27"},{"size":4575,"mtime":1621235663191,"results":"42","hashOfConfig":"27"},{"size":5057,"mtime":1621487940418,"results":"43","hashOfConfig":"27"},{"size":6713,"mtime":1621222368830,"results":"44","hashOfConfig":"27"},{"size":1561,"mtime":1621487641017,"results":"45","hashOfConfig":"27"},{"size":582,"mtime":1620985760514,"results":"46","hashOfConfig":"27"},{"size":4619,"mtime":1621487991539,"results":"47","hashOfConfig":"27"},{"size":1817,"mtime":1620562736357,"results":"48","hashOfConfig":"27"},{"size":1786,"mtime":1620985063000,"results":"49","hashOfConfig":"27"},{"size":5646,"mtime":1616948517619,"results":"50","hashOfConfig":"27"},{"size":1041,"mtime":1621395816484,"results":"51","hashOfConfig":"27"},{"filePath":"52","messages":"53","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},"1o16w34",{"filePath":"55","messages":"56","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"57","messages":"58","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"59","usedDeprecatedRules":"54"},{"filePath":"60","messages":"61","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"62","messages":"63","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"64","usedDeprecatedRules":"54"},{"filePath":"65","messages":"66","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"67","messages":"68","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"69","messages":"70","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"71","messages":"72","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"73","usedDeprecatedRules":"54"},{"filePath":"74","messages":"75","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"76","usedDeprecatedRules":"54"},{"filePath":"77","messages":"78","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"79","messages":"80","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"81","usedDeprecatedRules":"54"},{"filePath":"82","messages":"83","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"84","messages":"85","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"54"},{"filePath":"86","messages":"87","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"88","messages":"89","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"90","usedDeprecatedRules":"54"},{"filePath":"91","messages":"92","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"93","usedDeprecatedRules":"54"},{"filePath":"94","messages":"95","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"96","usedDeprecatedRules":"54"},{"filePath":"97","messages":"98","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"99","usedDeprecatedRules":"54"},{"filePath":"100","messages":"101","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"102","usedDeprecatedRules":"54"},{"filePath":"103","messages":"104","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"105","usedDeprecatedRules":"54"},{"filePath":"106","messages":"107","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"108","messages":"109","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"110","usedDeprecatedRules":"54"},{"filePath":"111","messages":"112","errorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"113","usedDeprecatedRules":"54"},{"filePath":"114","messages":"115","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"116","usedDeprecatedRules":"54"},"D:\\Work\\elemart-salary\\src\\index.tsx",[],["117","118"],"D:\\Work\\elemart-salary\\src\\reportWebVitals.ts",[],"D:\\Work\\elemart-salary\\src\\App.tsx",["119","120","121","122"],"import React, { useEffect } from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport { Layout, Menu } from 'antd'\nimport { SiderComponent } from './components/SiderComponent'\nimport { Switch, Route } from 'react-router-dom'\nimport { RoutePath } from './utils/RouterPath';\nimport { Page } from './types/Page';\nimport { HeaderComponent } from './components/HeaderComponent';\nimport { Footer } from 'antd/lib/layout/layout';\nfunction App() {\n  useEffect(() => {\n    document.title = 'เงินเดือน'\n  }, []);\n  return (\n    <>\n      <Layout>\n        <Layout>\n          <SiderComponent />\n          <Layout className='right-content'>\n            <Switch>\n              {RoutePath.map((page: Page) => {\n                return <Route path={page.path} component={page.component} exact></Route>\n              })}\n            </Switch>\n          </Layout>\n        </Layout>\n      </Layout>\n    </>\n  );\n}\n\nexport default App;\n","D:\\Work\\elemart-salary\\src\\utils\\RouterPath.ts",[],"D:\\Work\\elemart-salary\\src\\components\\SiderComponent.tsx",["123","124","125","126"],"import React, { useEffect, useState } from 'react'\r\nimport { Layout, Menu, PageHeader } from \"antd\";\r\nimport { RoutePath } from '../utils/RouterPath'\r\nimport { Page } from '../types/Page';\r\nimport { useHistory } from 'react-router-dom'\r\nconst { SubMenu } = Menu;\r\nconst { Content, Sider, Header } = Layout\r\n\r\nexport const SiderComponent: React.FC = () => {\r\n    const [activePage, setActivePage] = useState(RoutePath[0].pathName);\r\n    const history = useHistory()\r\n    const navigatePage = (e: any, page: any) => {\r\n        history.push(page.path)\r\n        setActivePage(page.pathName);\r\n    }\r\n    \r\n    return (\r\n        <>\r\n            <Sider theme=\"light\" className='siderHeader'>\r\n                <PageHeader title=\"ELEMART\"  style={{height:72,borderBottom:'2px solid #e7e7e7'}} />\r\n                <Menu\r\n                    mode=\"inline\"\r\n                    activeKey={activePage}\r\n                    defaultSelectedKeys={[activePage]}\r\n                    style={{ borderRight: 0 }}\r\n                >\r\n                    {RoutePath.map((page: Page) => {\r\n                        return page.isMenu ? <Menu.Item key={page.pathName} onClick={e => navigatePage(e, page)}>{page.pathName}</Menu.Item>:<></>\r\n                    })}\r\n                </Menu>\r\n            </Sider>\r\n        </>\r\n    )\r\n}","D:\\Work\\elemart-salary\\src\\pages\\EmployeePage\\EmployeePage.tsx",[],"D:\\Work\\elemart-salary\\src\\pages\\DashboardPage\\DashboardPage.tsx",[],"D:\\Work\\elemart-salary\\src\\pages\\SalaryListPage\\SaralyListPage.tsx",[],"D:\\Work\\elemart-salary\\src\\components\\HeaderComponent.tsx",["127"],"import React,{useState} from 'react'\r\nimport { Button, Layout, Menu } from 'antd'\r\nimport { CustomModal } from './CustomModal/CustomModal'\r\nimport { HeaderProps } from '../types/StoreTypes'\r\nconst { Header } = Layout\r\n\r\nexport const HeaderComponent: React.FC<HeaderProps> = ({ title, linkPath, nameOfLinkPath, component, modalWidth }) => {\r\n    const [visiblity, setVisiblity] = useState(false)\r\n    const handleClick = () => {\r\n        setVisiblity(true)\r\n    }\r\n    const handleClose = () => {\r\n        setVisiblity(false)\r\n    }\r\n    return <Header className=\"contentHeader\">\r\n        <div style={{position:'relative'}}>\r\n            <span>{title}</span>\r\n            <Button className='createBtn' style={{  }} onClick={handleClick} >{nameOfLinkPath}</Button>\r\n            <CustomModal modalTitle={nameOfLinkPath} modalType=\"paid-invoice\" modalForm={component}  modalWidth={modalWidth} modalVisible={visiblity} getClose={handleClose} />\r\n        </div>\r\n    </Header>\r\n}\r\n","D:\\Work\\elemart-salary\\src\\components\\AddEmployeeForm\\AddEmployeeForm.tsx",["128","129"],"import { useState, useEffect } from 'react'\r\nimport { Button, Input, InputNumber } from 'antd'\r\nimport { EmployeeApi } from '../../api/EmployeeApi'\r\nexport const AddEmployeeForm: React.FC = () => {\r\n    const [firstname, setFirstname] = useState('')\r\n    const [lastname, setLastname] = useState('')\r\n    const [salary, setSalary] = useState(0)\r\n    const [showHaveAccount, setShowHaveAccount] = useState(false)\r\n    const onSave = async () => {\r\n        const employeeForm: any = {\r\n            firstname: firstname,\r\n            lastname: lastname,\r\n            current_salary: salary,\r\n            social_security : salary >= 15000 ? 750 : salary * 0.05,\r\n            total_social_security: 0\r\n        }\r\n        await EmployeeApi.addEmployee(employeeForm)\r\n    }\r\n    return <div>\r\n        <div>\r\n            <Input placeholder='ชื่อ' onChange={e => setFirstname(e.target.value)} style={{ width: 720, marginLeft: 15 }} />\r\n        </div>\r\n        <div style={{ marginTop: 15 }}>\r\n            <Input placeholder='สกุล' onChange={e => setLastname(e.target.value)} style={{ width: 720, marginLeft: 15 }} />\r\n        </div>\r\n        <div style={{ marginTop: 15 }}>\r\n            <InputNumber placeholder='เงินเดือน' onChange={(value: number) => setSalary(value)} style={{ width: 720, marginLeft: 15 }} />\r\n        </div>\r\n        <div style={{ margin: '15px auto', textAlign: 'center' }}>\r\n            <Button type='primary' onClick={onSave}>เพิ่มพนักงาน</Button>\r\n        </div>\r\n        {showHaveAccount ? <span style={{ color: 'red' }}>มีชื่อลูกค้ารายนี้แล้ว</span> : null}\r\n    </div>\r\n}","D:\\Work\\elemart-salary\\src\\components\\CustomModal\\CustomModal.tsx",[],"D:\\Work\\elemart-salary\\src\\api\\EmployeeApi.ts",["130","131","132"],"import { BACKEND_API } from '../config'\r\nimport axios from 'axios'\r\nconst EMPLOYEE_API_URL = `${BACKEND_API}/employees`\r\nexport class EmployeeApi {\r\n    static async addEmployee(data: any) {\r\n        const result = await axios.post(`${EMPLOYEE_API_URL}/addEmployee`,data).then(res=>{\r\n            if(res.data.data === 'successful'){\r\n                window.location.reload()\r\n            }\r\n        })\r\n    }\r\n\r\n    static async findAllEmployees() {\r\n        const result = await axios.get(`${EMPLOYEE_API_URL}/findall`).then(res=>{\r\n            if(res.status === 200) return res.data\r\n        })\r\n        return result\r\n    }\r\n\r\n    static async findEmployeeByEmployeeId(employee_id:string) {\r\n        const result = await axios.get(`${EMPLOYEE_API_URL}/`+employee_id).then(res=>{\r\n            if(res.status === 200) return res.data\r\n        })\r\n        \r\n        return result\r\n    }\r\n\r\n    static async updateEmployeeByEmployeeId(employee_id,data:any){\r\n        const result = await axios.put(`${EMPLOYEE_API_URL}/`+employee_id,data).then(res=>{\r\n            if(res.data === 'successful') window.location.reload()\r\n        })\r\n    }\r\n    \r\n    static async deleteEmployeeByEmployeeId(employee_id:string){\r\n        const result = await axios.delete(`${EMPLOYEE_API_URL}/`+employee_id).then(res=>{\r\n             window.location.reload()\r\n        })\r\n    }\r\n}","D:\\Work\\elemart-salary\\src\\config.ts",[],"D:\\Work\\elemart-salary\\src\\mockData\\mockColumnTable.tsx",[],"D:\\Work\\elemart-salary\\src\\pages\\EmployeeInfo\\EmployeeInfoPage.tsx",["133","134"],"D:\\Work\\elemart-salary\\src\\components\\AddSalaryForm\\AddSalaryForm.tsx",["135","136","137","138","139","140"],"import { useState, useEffect } from 'react'\r\nimport { Button, DatePicker, Input, notification } from 'antd'\r\nimport { EmployeeApi } from '../../api/EmployeeApi'\r\nimport { EditableTable } from '../EditTable/EditableTable'\r\nimport { AddSalaryColumn, salaryMonthColumn } from '../../mockData/mockColumnTable'\r\nimport { ReportApi } from '../../api/ReportApi'\r\nimport { IDataProps } from '../../types/StoreTypes'\r\nimport moment from 'moment'\r\n\r\nexport const AddSalaryForm: React.FC = () => {\r\n    const [dataTable, setdataTable] = useState([] as Array<IDataProps>)\r\n    const [monthPicker, setMonthPicker] = useState('' as string)\r\n    const [getKeyDown, setKeyDown] = useState(false)\r\n    const [userData, setUserData] = useState([] as Array<IDataProps>)\r\n    const [alertInputMonth, setAlertInputMonth] = useState(false);\r\n    useEffect(() => {\r\n        const pushkeydown = (event: any) => {\r\n            if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\r\n                console.log(\"Enter key was pressed. Run your function.\");\r\n                setKeyDown(true)\r\n                event.preventDefault();\r\n            }\r\n        };\r\n        const pushkeyup = (event: any) => {\r\n            setKeyDown(false)\r\n        }\r\n        document.addEventListener(\"keydown\", pushkeydown);\r\n        document.addEventListener(\"keyup\", pushkeyup);\r\n        EmployeeApi.findAllEmployees().then(res => {\r\n            const storeObj: Array<IDataProps> = []\r\n            res.map((data, index) => {\r\n                storeObj.push(\r\n                    {\r\n                        fullname: data.fullname,\r\n                        absent: 0,\r\n                        agent: 0,\r\n                        agent_tax: 0,\r\n                        allowance: 0,\r\n                        bonus: 0,\r\n                        bonus_tax: 0,\r\n                        fuel: 0,\r\n                        late: 0,\r\n                        key: index + 1,\r\n                        lending: 0,\r\n                        no: index + 1,\r\n                        overtime: 0,\r\n                        salary: data.current_salary,\r\n                        social_security: data.social_security,\r\n                        tax: 0,\r\n                        operation: null\r\n                    }\r\n                )\r\n            })\r\n            setUserData(storeObj)\r\n        })\r\n        return () => {\r\n            document.removeEventListener(\"keydown\", pushkeydown);\r\n            document.removeEventListener(\"keyup\", pushkeyup);\r\n        };\r\n    }, []);\r\n\r\n    const onSave = async () => {\r\n        const result = dataTable.map((d: IDataProps) => {\r\n            delete d.operation\r\n            return d\r\n        })\r\n        const salaryDataForm = {\r\n            year_of_report: monthPicker.split('/')[1],\r\n            month_report: monthPicker,\r\n            attributes: result\r\n        }\r\n        if (monthPicker !== \"\") {\r\n            await ReportApi.addReport(salaryDataForm)\r\n        } else {\r\n            notificationOpen()\r\n            setAlertInputMonth(true)\r\n        }\r\n    }\r\n    \r\n    const notificationOpen = () => {\r\n        setAlertInputMonth(!alertInputMonth)\r\n        notification['error']({\r\n            message:'เกิดข้อผิดพลาด',\r\n            description:'กรุณาเลือกเดือน-ปีของรายงาน',\r\n            style: {\r\n                width: 600,\r\n              },\r\n            duration:3\r\n        })\r\n    }\r\n\r\n    const getTableData = (data: Array<IDataProps>) => {\r\n        // \r\n        EmployeeApi.findAllEmployees().then(res => {\r\n            const storeRes = res\r\n            data.map(d => {\r\n                const result = storeRes.find(ds => ds.fullname === d.fullname)\r\n                if (result !== undefined) d.employees_id = result.employee_id\r\n\r\n            })\r\n            setdataTable(data)\r\n        })\r\n    }\r\n\r\n\r\n    return <div>\r\n        <div style={{ marginBottom: 15 }}>\r\n            <span>เดือนที่</span> <DatePicker format={'MM/YYYY'} picker=\"month\" onChange={(date: any, dateString: string) => setMonthPicker(dateString)} />\r\n\r\n        </div>\r\n        <div>\r\n            <EditableTable column={AddSalaryColumn} getData={getTableData} oldData={userData} ablePagination={{ disabled: false }} showData={15} startCount={1} formType={'salary-month'}  />\r\n        </div>\r\n        <div style={{ margin: '15px auto', textAlign: 'center' }}>\r\n            <Button type='primary' onClick={onSave}>เพิ่มรายงานเงินเดือน</Button>\r\n        </div>\r\n    </div>\r\n}","D:\\Work\\elemart-salary\\src\\components\\EditTable\\EditableTable.tsx",["141","142","143","144","145","146"],"import { useEffect, useState } from 'react'\r\nimport { Button, Table, Popconfirm } from 'antd'\r\nimport {\r\n    EditableCell,\r\n    EditableRow,\r\n} from './EditableCell';\r\nimport { TablePaginationConfig } from 'antd/lib/table';\r\nimport { EmployeeApi } from '../../api/EmployeeApi';\r\nimport { TableProps } from '../../types/EditTableTypes';\r\n\r\n\r\n\r\nexport const EditableTable: React.FC<TableProps> = (props: any) => {\r\n    const [dataSources, setDataSource] = useState(props.oldData)\r\n    const [count, setCount] = useState(props.startCount)\r\n    const [showData, setShowData] = useState(0)\r\n\r\n    useEffect(() => {\r\n        if (props.checkEnter)\r\n            handleAdd()\r\n        return () => {\r\n\r\n        };\r\n    }, [props.checkEnter]);\r\n\r\n    useEffect(() => {\r\n        setDataSource(props.oldData)\r\n    }, [props.oldData]);\r\n\r\n    useEffect(() => {\r\n        setShowData(props.showData)\r\n    }, [props.showData]);\r\n\r\n    useEffect(() => {\r\n        dataSources.map((data: any, index: number) => {\r\n            data.key = index + 1\r\n            handleOperation(data);\r\n            return data;\r\n        });\r\n        if (props.getData !== undefined) props.getData(dataSources)\r\n    }, [dataSources])\r\n\r\n    const handleOperation = (data: any) => {\r\n        data.operation = (\r\n            <Popconfirm\r\n                title=\"Sure to delete?\"\r\n                onConfirm={() => handleDelete(data.key)}\r\n            >\r\n                <a style={{ color: 'red' }}>Delete</a>\r\n            </Popconfirm>\r\n        );\r\n        return data.operation\r\n    };\r\n\r\n    const handleDelete = (key: number) => {\r\n        const filterData = dataSources.filter((item: any) => item.key !== key)\r\n        setDataSource(filterData);\r\n        setCount(count - 1)\r\n    };\r\n\r\n    const handleSave = (row: any) => {\r\n        if (props.column[7].key === \"social_security\" && !props.column[7].editable) {\r\n            row.social_security = row.salary >= 15000 ? 750 : row.salary * 0.05\r\n        }\r\n        row.agent_tax = row.agent * 0.05\r\n        const newData = [...dataSources];\r\n        const index = newData.findIndex((item: any) => row.key === item.key);\r\n        const item = newData[index];\r\n        newData.splice(index, 1, {\r\n            ...item,\r\n            ...row,\r\n        });\r\n        setDataSource(newData);\r\n    };\r\n\r\n    const components = {\r\n        body: {\r\n            row: EditableRow,\r\n            cell: EditableCell,\r\n        },\r\n    };\r\n\r\n    const mapColumns = (col: any) => {\r\n        if (!col.editable) {\r\n            return col;\r\n        }\r\n        const newCol = {\r\n            ...col,\r\n            onCell: (record: any) => ({\r\n                record,\r\n                editable: col.editable,\r\n                dataIndex: col.dataIndex,\r\n                title: col.title,\r\n                children: col.children,\r\n                dataType: col.dataType,\r\n                formType: props.formType,\r\n                handleSave,\r\n            }),\r\n        };\r\n        if (col.children) {\r\n            newCol.children = col.children.map(mapColumns);\r\n        }\r\n        return newCol;\r\n    };\r\n    const canEditChildColumns = props.column.map(mapColumns);\r\n    const handleAdd = () => {\r\n        const storeData = {};\r\n\r\n        props.column.forEach((data: any) => {\r\n            if (data.children) {\r\n                data.children.forEach((insideChildren: any) => {\r\n                    if (insideChildren.dataType === 'number') {\r\n                        Object.assign(storeData, { [insideChildren.dataIndex]: 0 });\r\n                    } else {\r\n                        Object.assign(storeData, { [insideChildren.dataIndex]: '-' });\r\n                    }\r\n                });\r\n            } else {\r\n                if (data.dataType === 'number') {\r\n                    Object.assign(storeData, { [data.dataIndex]: 0 });\r\n                } else if (data.dataType === 'action') {\r\n                    Object.assign(storeData, { [data.dataIndex]: handleOperation(data) })\r\n                } else {\r\n                    Object.assign(storeData, { [data.dataIndex]: '-' });\r\n                    Object.assign(storeData, { key: count });\r\n                    Object.assign(storeData, { no: count });\r\n                }\r\n            }\r\n        });\r\n\r\n        const newData = {\r\n            // key: count,\r\n            ...storeData,\r\n        };\r\n        setCount(count + 1);\r\n        setDataSource([...dataSources, newData]);\r\n    }\r\n\r\n    const AddBtn = () => {\r\n        return (<>\r\n            <Button onClick={handleAdd} style={{ marginBottom: 15 }} type='primary' >\r\n                Add row\r\n            </Button>\r\n        </>\r\n        );\r\n    };\r\n    return <div>\r\n        <Table\r\n            columns={canEditChildColumns}\r\n            dataSource={dataSources}\r\n            components={components}\r\n            bordered\r\n            style={{ width: '100%' }}\r\n            // pagination={props.ablePagination}\r\n            pagination={{ pageSize: showData }}\r\n            scroll={{ x: '100vw', y: '100%' }}\r\n\r\n        />\r\n        {/* <AddBtn /> */}\r\n\r\n    </div>\r\n}","D:\\Work\\elemart-salary\\src\\components\\EditTable\\EditableCell.tsx",["147","148"],"import React, { useContext, useState, useEffect, createRef } from 'react';\r\nimport { Select, TimePicker, Form, DatePicker, Radio, Input, InputNumber } from 'antd';\r\nimport moment from 'moment';\r\nimport TH_LOCAL from 'antd/es/date-picker/locale/th_TH';\r\nimport { EmployeeApi } from '../../api/EmployeeApi';\r\nimport { EditableRowProps, EditableCellProps } from '../../types/EditTableTypes';\r\n\r\n\r\n\r\nconst EditableContext = React.createContext<any>(null);\r\n\r\nexport const EditableRow: React.FC<EditableRowProps> = ({\r\n  index,\r\n  ...props\r\n}) => {\r\n  const [form] = Form.useForm();\r\n  return (\r\n    <Form form={form} component={false}>\r\n      <EditableContext.Provider value={form}>\r\n        <tr {...props} />\r\n      </EditableContext.Provider>\r\n    </Form>\r\n  );\r\n};\r\nexport const EditableCell: React.FC<EditableCellProps> = ({\r\n  title,\r\n  editable,\r\n  children,\r\n  dataIndex,\r\n  dataType,\r\n  tableType,\r\n  record,\r\n  formType,\r\n  handleSave,\r\n  handleDelete,\r\n  ...restProps\r\n}) => {\r\n  const [editing, setEditing] = useState(false);\r\n  const [employeeData, setEmployeeData] = useState([] as Array<Object>)\r\n  const inputRef = createRef<Input>();\r\n  const form = useContext(EditableContext);\r\n  useEffect(() => {\r\n    if (editing) {\r\n      inputRef.current?.focus();\r\n    }\r\n  }, [editing]);\r\n\r\n  useEffect(() => {\r\n    if (dataIndex === 'fullname') {\r\n      EmployeeApi.findAllEmployees().then(res => {\r\n        setEmployeeData(res)\r\n      })\r\n    }\r\n  }, []);\r\n\r\n  const toggleEdit = () => {\r\n    setEditing(!editing);\r\n    if (record[dataIndex] !== '-') {\r\n      if (dataType === 'date') {\r\n        form.setFieldsValue({\r\n          [dataIndex]: moment(record[dataIndex], 'DD/MM/YYYY'),\r\n        });\r\n      } else if (dataType === 'date_time') {\r\n        form.setFieldsValue({\r\n          [dataIndex]: moment(record[dataIndex], 'DD/MM/YYYY HH:mm'),\r\n        });\r\n      } else if (dataType === 'time') {\r\n        form.setFieldsValue({\r\n          [dataIndex]: moment(record[dataIndex], 'HH:mm'),\r\n        });\r\n      } else {\r\n        form.setFieldsValue({ [dataIndex]: record[dataIndex] });\r\n      }\r\n    }\r\n  };\r\n\r\n  const save = async (e: any) => {\r\n    try {\r\n      const values = await form.validateFields();\r\n      toggleEdit();\r\n      // const result:any = employeeData.filter((data:any)=>data.fullname===values.fullname) \r\n      // Object.assign(values,{salary:result[0].current_salary}) // Add current salary of employee      \r\n      handleSave({ ...record, ...values });\r\n    } catch (errInfo) {\r\n      console.log('Save failed:', errInfo);\r\n    }\r\n  };\r\n\r\n  let childNode = children;\r\n  if (editable) {\r\n    if (editing) {\r\n      if (dataType === 'radio') {\r\n        childNode = (\r\n          <Form.Item style={{ margin: 0 }} name={dataIndex}>\r\n            {dataIndex === 'fruit_size' ? (\r\n              <Radio.Group onChange={save}>\r\n                <Radio value=\"ใหญ่\">ใหญ่</Radio>\r\n                <Radio value=\"กลาง\">กลาง</Radio>\r\n                <Radio value=\"เล็ก\">เล็ก</Radio>\r\n                <Radio value=\"ชิ้น\">ชิ้น</Radio>\r\n              </Radio.Group>\r\n            ) : dataIndex === 'status' ? (\r\n              <Radio.Group onChange={save}>\r\n                <Radio value=\"สด\">สด</Radio>\r\n                <Radio value=\"เปลี่ยนมุ้ง\">เปลี่ยนมุ้ง</Radio>\r\n                <Radio value=\"คลุก\">คลุก</Radio>\r\n                <Radio value=\"อบใหม่\">อบใหม่</Radio>\r\n              </Radio.Group>\r\n            ) : dataIndex === 'soaking_type' ? (\r\n              <Radio.Group onChange={save}>\r\n                <Radio value=\"บ่อแช่\">บ่อแช่</Radio>\r\n                <Radio value=\"ถัง\">ถัง</Radio>\r\n              </Radio.Group>\r\n            ) : dataIndex === 'fruit_path' ? (\r\n              <Radio.Group onChange={save}>\r\n                <Radio value=\"NORMAL\">Normal</Radio>\r\n                <Radio value=\"SOFT\">SOFT</Radio>\r\n                <Radio value=\"FREE SUGAR\">FREE SUGAR</Radio>\r\n                <Radio value=\"FREE SO2\">FREE SO2</Radio>\r\n              </Radio.Group>\r\n            ) : (\r\n              <Radio.Group onChange={save}>\r\n                <Radio value=\"ผ่าน\">ผ่าน</Radio>\r\n                <Radio value=\"ไม่ผ่าน\">ไม่ผ่าน</Radio>\r\n              </Radio.Group>\r\n            )}\r\n          </Form.Item>\r\n        );\r\n      } else if (dataType === 'date') {\r\n        childNode = (\r\n          <Form.Item style={{ margin: 0 }} name={dataIndex}>\r\n            <DatePicker onBlur={save} format={'DD/MM/YYYY'} locale={TH_LOCAL} />\r\n          </Form.Item>\r\n        );\r\n      } else if (dataType === 'date_time') {\r\n        childNode = (\r\n          <Form.Item style={{ margin: 0 }} name={dataIndex}>\r\n            <DatePicker\r\n              onBlur={save}\r\n              showTime\r\n              format={'DD/MM/YYYY HH:mm'}\r\n              locale={TH_LOCAL}\r\n            />\r\n          </Form.Item>\r\n        );\r\n      } else if (dataType === 'time') {\r\n        childNode = (\r\n          <Form.Item style={{ margin: 0 }} name={dataIndex}>\r\n            <TimePicker onBlur={save} />\r\n          </Form.Item>\r\n        );\r\n      } else if (dataType === 'select') {\r\n        childNode = (\r\n          <Form.Item\r\n            style={{ margin: 0 }}\r\n            name={dataIndex}\r\n            rules={[\r\n              {\r\n                required: true,\r\n                message: `${title} is required.`,\r\n              },\r\n            ]}\r\n          >\r\n            {dataIndex === 'fullname' ? (\r\n              <Select onBlur={save} showSearch>\r\n                {employeeData.length > 0 && employeeData.map((data: any) => {\r\n                  return <Select.Option key={data.employee_id} value={data.fullname}>{data.fullname}</Select.Option>\r\n                })}\r\n              </Select>\r\n            ) : null}\r\n          </Form.Item>\r\n        );\r\n      } else if (dataType === 'number') {\r\n        childNode = (\r\n          <Form.Item style={{ margin: 0 }} name={dataIndex}>\r\n            <InputNumber min={0} onPressEnter={save} onBlur={save} />\r\n          </Form.Item>\r\n        );\r\n      } else {\r\n        childNode = (\r\n          <Form.Item style={{ margin: 0 }} name={dataIndex}>\r\n            <Input ref={inputRef} onPressEnter={save} onBlur={save} />\r\n          </Form.Item>\r\n        );\r\n      }\r\n    } else {\r\n      childNode = (\r\n        <div\r\n          className=\"editable-cell-value-wrap\"\r\n          style={{ paddingRight: 24 }}\r\n          onClick={toggleEdit}\r\n        >\r\n          {children}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n  return <td {...restProps}>{childNode}</td>;\r\n};\r\n","D:\\Work\\elemart-salary\\src\\api\\ReportApi.ts",["149","150"],"import axios from \"axios\";\r\nimport { BACKEND_API } from \"../config\";\r\n\r\n\r\nconst REPORT_API = `${BACKEND_API}/reports`\r\n\r\nexport class ReportApi {\r\n    static async addReport(data: Object) {\r\n        await axios.post(`${REPORT_API}/AddReport`, data).then(res => {\r\n            if (res.status === 201) window.location.reload()\r\n        })\r\n    }\r\n\r\n    static async findAllReports(params: any) {\r\n        const result = await axios.get(`${REPORT_API}/findall`, { params }).then(res => {\r\n            return res.data\r\n        })\r\n        return result\r\n    }\r\n\r\n    static async findSalaryList(params: any) {\r\n        const result = await axios.get(`${REPORT_API}/findSalaryList`, { params }).then(res => {\r\n            if (res.status === 200) return res.data\r\n        })\r\n        return result\r\n    }\r\n    static async findSumLateAndSecuritySocial(params: any) {\r\n        const result = await axios.get(`${REPORT_API}/findTotalSecuritySocialAndLate`, { params }).then(res => {\r\n            if (res.status === 200) return res.data\r\n        })\r\n        console.log(result)\r\n        return result\r\n    }\r\n    static async deleteReportById(report_id: string) {\r\n        const result = await axios.delete(`${REPORT_API}/${report_id}`).then(res => {\r\n            if (res.status === 200) window.location.reload()\r\n        })\r\n    }\r\n\r\n    static async updateReportByReportID(report_id,data:any){\r\n        const result = await axios.put(`${REPORT_API}/`+report_id,data).then(res=>{\r\n            if(res.data === 'successful') window.location.reload()\r\n        })\r\n    }\r\n}","D:\\Work\\elemart-salary\\src\\utils\\AddComma.ts",["151"],"import { IReportProps } from \"../types/StoreTypes\";\r\n\r\nexport const AddComma = (data: number) => {\r\n    return data.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n}\r\n\r\nexport const AddCommaOfObject = (data: any) => {\r\n    const keys = Object.keys(data)\r\n    const obj = {} as IReportProps\r\n    keys.map((key: string) => {\r\n        if (typeof (data[key]) !== \"string\" && typeof (data[key]) !== \"object\") {\r\n            const d = data[key].toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n            return Object.assign(obj, { [key]: d })\r\n        }\r\n    })\r\n    return obj\r\n}","D:\\Work\\elemart-salary\\src\\pages\\SalaryListInfoPage\\SalaryInfoPage.tsx",["152","153","154"],"import { Button, Popconfirm, Switch, Table } from 'antd'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { ReportApi } from '../../api/ReportApi'\r\nimport { HeaderComponent } from '../../components/HeaderComponent'\r\nimport { AddSalaryColumn } from '../../mockData/mockColumnTable'\r\nimport { IReportProps } from '../../types/StoreTypes'\r\nimport { generateExcel } from '../../components/Excel/ExcelComponent'\r\nimport { EditableCell } from '../../components/EditTable/EditableCell'\r\nimport { EditableTable } from '../../components/EditTable/EditableTable'\r\nconst monthVal = [\r\n    {\r\n        key: '01',\r\n        value: 'ม.ค.'\r\n    },\r\n    {\r\n        key: '02',\r\n        value: 'ก.พ.'\r\n    },\r\n    {\r\n        key: '03',\r\n        value: 'มี.ค.'\r\n    },\r\n    {\r\n        key: '04',\r\n        value: 'เม.ย.'\r\n    },\r\n    {\r\n        key: '05',\r\n        value: 'พ.ค.'\r\n    },\r\n    {\r\n        key: '06',\r\n        value: 'มิ.ย.'\r\n    },\r\n    {\r\n        key: '07',\r\n        value: 'ก.ค.'\r\n    },\r\n    {\r\n        key: '08',\r\n        value: 'ส.ค.'\r\n    },\r\n    {\r\n        key: '09',\r\n        value: 'ก.ย.'\r\n    },\r\n    {\r\n        key: '10',\r\n        value: 'ต.ค.'\r\n    },\r\n    {\r\n        key: '11',\r\n        value: 'พ.ย.'\r\n    },\r\n    {\r\n        key: '12',\r\n        value: 'ธ.ค.'\r\n    },\r\n]\r\n\r\nexport const SalaryInfoPage: React.FC<{ match: any }> = ({ match }) => {\r\n    const { id } = match.params\r\n    const [dataSource, setDataSource] = useState([] as Array<IReportProps>);\r\n    const [monthReport, setMonthReport] = useState('');\r\n    const [count, setCount] = useState(0);\r\n    const [canEdit, setCanEdit] = useState(false)\r\n    useEffect(() => {\r\n        ReportApi.findAllReports({\r\n            filterObject: {\r\n                report_id: id\r\n            }\r\n        }).then(res => {\r\n            console.log(res)\r\n            const filterThaiMonth = monthVal.filter(d => d.key === res[0].month_report.split('/')[0])[0].value\r\n            setMonthReport(filterThaiMonth + ' ' + res[0].month_report.split('/')[1])\r\n            setDataSource(res[0].attributes)\r\n            setCount(res[0].attributes.length)\r\n        })\r\n\r\n        return () => {\r\n        };\r\n    }, [id]);\r\n\r\n    // const handleDelete = (key: number) => {\r\n    //     const filterData = dataSource.filter((item: any) => item.key !== key)\r\n    //     setDataSource(filterData);\r\n    //     setCount(count - 1)\r\n    // };\r\n\r\n    // const handleOperation = (data: any) => {\r\n    //     data.operation = (\r\n    //         <Popconfirm\r\n    //             title=\"Sure to delete?\"\r\n    //             onConfirm={() => handleDelete(data.key)}\r\n    //         >\r\n    //             <a style={{ color: 'red' }}>Delete</a>\r\n    //         </Popconfirm>\r\n    //     );\r\n    //     return data.operation\r\n    // };\r\n\r\n    // useEffect(() => {\r\n    //     dataSource.map((data: any, index: number) => {\r\n    //         data.key = index + 1\r\n    //         handleOperation(data);\r\n    //         return data;\r\n    //     });\r\n    // }, [dataSource])\r\n    const getTableData = (data: any) => {        // \r\n\r\n        setDataSource(data)\r\n    }\r\n    const updateData = () => {\r\n        const data = {\r\n            attributes:dataSource\r\n        }\r\n        ReportApi.updateReportByReportID(id,data)\r\n    }\r\n    \r\n    return <>\r\n        <HeaderComponent title={monthReport} nameOfLinkPath='' />\r\n        <div style={{ width: 250,marginTop:15 }}>\r\n            <Switch checkedChildren='ยกเลิกการแก้ไข' unCheckedChildren='แก้ไข' onChange={e => setCanEdit(!canEdit)} /> \r\n        </div>\r\n        <div style={{ marginTop: 15, marginRight: 15, textAlign: 'right' }}>\r\n            <Button\r\n                type='primary'\r\n                style={{ backgroundColor: '#2ec500', borderRadius: '5px', marginBottom: 15 }}\r\n                onClick={e =>\r\n                    generateExcel(AddSalaryColumn, monthReport, dataSource)\r\n                }\r\n            >\r\n                Generate Excel\r\n                </Button>\r\n        </div>\r\n        {!canEdit ?\r\n                <Table className='t' columns={AddSalaryColumn} dataSource={dataSource} />\r\n            :\r\n            <EditableTable column={AddSalaryColumn} getData={getTableData} oldData={dataSource} ablePagination={{ disabled: false }} showData={10} startCount={1} formType={'salary-month'} />\r\n        }\r\n        {/* <Table className='t' columns={AddSalaryColumn} dataSource={dataSource} /> */}\r\n\r\n        {canEdit?<Button style={{width:150,marginLeft:10}} onClick={updateData} type='primary'>Update</Button>:null}\r\n\r\n    </>\r\n}","D:\\Work\\elemart-salary\\src\\components\\generatePDF\\generatePDF.tsx",["155","156","157"],"D:\\Work\\elemart-salary\\src\\components\\GeneratePDF\\GeneratePDF.tsx",["158","159"],"import { Button } from \"antd\";\r\nimport { SelectValue } from \"antd/lib/select\";\r\nimport html2canvas from \"html2canvas\";\r\nimport jsPDF from \"jspdf\";\r\nimport { useState } from \"react\";\r\ninterface IProps {\r\n    document: HTMLElement | null\r\n    fullname: string;\r\n    reportMonth: SelectValue\r\n\r\n}\r\nexport const GeneratePDF: React.FC<IProps> = ({ document, fullname, reportMonth }) => {\r\n    const [ready, setReady] = useState(false);\r\n    const printPdf = () => {\r\n        const input = document\r\n        console.log(input)\r\n        if (input !== null) {\r\n            html2canvas(input, { scale:2 }).then(canvas => {\r\n                \r\n                const imgData = canvas.toDataURL('image/png');\r\n                const pdf = new jsPDF('p', 'px', 'a4');\r\n                var pageWidth = pdf.internal.pageSize.getWidth();\r\n                var pageHeight = pdf.internal.pageSize.getHeight();\r\n                const widthRatio = pageWidth / canvas.width;\r\n                const heightRatio = pageHeight / canvas.height;\r\n                const ratio = widthRatio > heightRatio ? heightRatio : widthRatio;\r\n                const canvasWidth = canvas.width * ratio - 50;\r\n                const canvasHeight = canvas.height * ratio;\r\n                const marginX = (pageWidth - canvasWidth) / 2;\r\n                const marginY = 20// 0 if use class page //(pageHeight - canvasHeight) / 2\r\n                pdf.addImage(imgData, 'JPEG', marginX, marginY, canvasWidth, canvasHeight);\r\n                pdf.save(`${fullname + ' ' + reportMonth?.toString().split('/')[0] }.pdf`);\r\n            })\r\n        }\r\n    }\r\n    return <Button onClick={printPdf} type=\"primary\" style={{ backgroundColor: '#1B456B', borderColor: '#1B456B', position: 'absolute', right: 15 }} >PAYROLL Generate</Button>\r\n    \r\n}","D:\\Work\\elemart-salary\\src\\components\\Excel\\ExcelComponent.tsx",["160","161","162","163","164","165","166","167","168","169","170"],"import * as Excel from 'exceljs';\r\nimport { saveAs } from 'file-saver';\r\n\r\nconst createHeader = (keys: any) => {\r\n  const result: any[] = [];\r\n  keys.map((keyData: any) => {\r\n    if (keyData.children) {\r\n      keyData.children.map((childData: any) => {\r\n        result.push({\r\n          key: childData.dataIndex,\r\n          width: 20,\r\n        });\r\n      });\r\n    } else {\r\n      if (keyData.dataIndex !== 'operation') {\r\n        result.push({\r\n          key: keyData.dataIndex,\r\n          width: 20,\r\n        });\r\n      }\r\n    }\r\n  });\r\n  return result;\r\n};\r\nconst createThaiHeader = (keys: any) => {\r\n  const result: any[] = [];\r\n  const Obj = {};\r\n  keys.map((keyData: any) => {\r\n    const Obj2 = {};\r\n    if (keyData.children) {\r\n      Object.assign(Obj, { [keyData.dataIndex]: keyData.title });\r\n      keyData.children.map((childData: any) => {\r\n        Object.assign(Obj, { [childData.dataIndex]: childData.title });\r\n        Object.assign(Obj2, { [childData.dataIndex]: childData.title });\r\n      });\r\n      Object.assign(Obj, {\r\n        [keyData.dataIndex]: {\r\n          [keyData.children[0].dataIndex]: keyData.title,\r\n          children: Obj2,\r\n        },\r\n      });\r\n    } else {\r\n      Object.assign(Obj, { [keyData.dataIndex]: keyData.title });\r\n    }\r\n  });\r\n  result.push(Obj);\r\n  return result;\r\n};\r\nconst createSubheader = (\r\n  ws: Excel.Worksheet,\r\n  headers: object[],\r\n  CellName: string[]\r\n) => {\r\n  const storeChildren: any[] = [];\r\n  const storeSubChildren: any[] = [];\r\n  const storeChildrenLength: number[] = [];\r\n  const storeKeyInTable: any[] = [];\r\n  const headerData: any = {};\r\n\r\n  headers.map((da: any) => {\r\n    const headerKeys = Object.keys(da);\r\n    headerKeys.map(k => {\r\n      if (da[k].children) {\r\n        const childKey = Object.keys(da[k])[0];\r\n        storeChildren.push({ [childKey]: da[k][childKey] });\r\n        storeSubChildren.push(da[k].children);\r\n        storeChildrenLength.push(Object.keys(da[k].children).length);\r\n      }\r\n    });\r\n  });\r\n\r\n  const startKeyBeforeMerge = storeChildren.map(s => {\r\n    // merge cell จากหัวข้อเริ่มต้น\r\n    const childKey = Object.keys(s)[0];\r\n    const childVal = Object.values(s)[0];\r\n    Object.assign(headerData, { [childKey]: childVal });\r\n    return childKey;\r\n  });\r\n\r\n  storeSubChildren.map(s => {\r\n    const childKey = Object.keys(s);\r\n    childKey.map((key: any) => {\r\n      storeKeyInTable.push(key);\r\n    });\r\n    return childKey;\r\n  });\r\n\r\n  CellName.map((name: any, index: number) => {\r\n    ws.mergeCells(name + ':' + name.slice(0, name.length - 1) + '6');\r\n  });\r\n\r\n  storeKeyInTable.map(key => {\r\n    // move value to row 6\r\n    const idCol = ws.getColumn(key);\r\n    if (idCol.number !== undefined) {\r\n      const colAddress = ws.getRow(5).getCell(idCol.number).address;\r\n      ws.unMergeCells(colAddress);\r\n      CellName.map((name: any) => {\r\n        ws.getCell(name.slice(0, name.length - 1) + '6').value = ws.getCell(\r\n          name\r\n        ).value;\r\n      });\r\n    }\r\n  });\r\n\r\n  startKeyBeforeMerge.map((startKey: any, index: number) => {\r\n    // merge cell of header\r\n    const idCol = ws.getColumn(startKey);\r\n    if (idCol.number !== undefined) {\r\n      const colAddress = ws.getRow(5).getCell(idCol.number).address;\r\n      const startCol = Number.parseInt(\r\n        ws.getRow(5).getCell(idCol.number).col,\r\n        10\r\n      );\r\n      const endCol =\r\n        Number.parseInt(ws.getRow(5).getCell(idCol.number).col, 10) +\r\n        storeChildrenLength[index] -\r\n        1;\r\n      ws.getCell(colAddress).value = headerData[startKey];\r\n      ws.mergeCells(5, startCol, 5, endCol);\r\n    }\r\n  });\r\n  return ws;\r\n};\r\n\r\nexport const generateExcel = async (column: any, name: string, data: any) => {\r\n  const headers = createHeader(column);\r\n  const thaiHeaders = createThaiHeader(column);\r\n  const storeCellName: string[] = [];\r\n  const blobType =\r\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\r\n  const workbook = new Excel.Workbook();\r\n  const ws = workbook.addWorksheet(name, {\r\n    pageSetup: { fitToPage: true, orientation: 'landscape', paperSize: 9 },\r\n  });\r\n  const lastColumnGreater26 = ws.getCell(1, headers.length).address.slice(0, 2);\r\n  const lastColumnLess26 = ws.getCell(1, headers.length).address.slice(0, 1);\r\n  if (headers.length <= 26) {\r\n    ws.mergeCells('A1:' + lastColumnLess26 + '2');\r\n  } else {\r\n    ws.mergeCells('A1:' + lastColumnGreater26 + '2');\r\n  }\r\n  ws.getCell('A1').value = name;\r\n  ws.columns = headers;\r\n  ws.addRow([]);\r\n  ws.addRow([]);\r\n  ws.addRows(thaiHeaders);\r\n  ws.eachRow(row => {\r\n    row.eachCell(cell => {\r\n      if (cell.address.slice(-1) === '5') {\r\n        storeCellName.push(cell.address);\r\n      }\r\n    });\r\n  });\r\n\r\n  const updateSubheaderWs = createSubheader(ws, thaiHeaders, storeCellName);\r\n\r\n  updateSubheaderWs.addRows(data);\r\n  updateSubheaderWs.eachRow(row => {\r\n    row.eachCell(cell => {\r\n      cell.alignment = {\r\n        horizontal: 'center',\r\n        vertical: 'middle',\r\n      };\r\n      cell.border = {\r\n        top: { style: 'medium' },\r\n        left: { style: 'medium' },\r\n        bottom: { style: 'medium' },\r\n        right: { style: 'medium' },\r\n      };\r\n    });\r\n  });\r\n\r\n  updateSubheaderWs.getCell('A1').border = {\r\n    top: { style: undefined },\r\n    left: { style: undefined },\r\n    bottom: { style: undefined },\r\n    right: { style: undefined },\r\n  };\r\n  updateSubheaderWs.getCell('A1').font = {\r\n    size: 14,\r\n    bold: true,\r\n  };\r\n  await workbook.xlsx.writeBuffer().then(data => {\r\n    const blob = new Blob([data], { type: blobType });\r\n    saveAs(blob, name + '.xlsx');\r\n  });\r\n};\r\n","D:\\Work\\elemart-salary\\src\\pages\\SettingPage\\SettingPage.tsx",["171"],"import { Button, Input } from 'antd'\r\nimport React, { useEffect, useState } from 'react'\r\n\r\nexport const SettingPage: React.FC = () => {\r\n    const [currentIp, setCurrentIp] = useState('');\r\n    const [showCurrentIp, setShowCurrentIp] = useState('');\r\n    useEffect(() => {\r\n        const getIP = localStorage.getItem('storeIP')\r\n        const show = getIP !== null ? setShowCurrentIp(getIP) : setShowCurrentIp('กรุณากรอกไอพี')\r\n    }, []);\r\n    const handleOnclick = e => {\r\n        localStorage.setItem('storeIP', currentIp)\r\n        window.location.reload()\r\n    }\r\n\r\n    return <div style={{ marginTop: 15, marginLeft: 15 }}>\r\n        <div style={{marginBottom:15}}>\r\n            <span>Current IP : {showCurrentIp} </span>\r\n        </div>\r\n        <div style={{ width: 300 }}>\r\n            <Input placeholder='backend ip' style={{ width: 150, marginRight: 15 }} onChange={e => setCurrentIp(e.target.value)} /><Button type='primary' onClick={e => handleOnclick(e)} >update</Button>\r\n        </div>\r\n    </div>\r\n}",{"ruleId":"172","replacedBy":"173"},{"ruleId":"174","replacedBy":"175"},{"ruleId":"176","severity":1,"message":"177","line":2,"column":8,"nodeType":"178","messageId":"179","endLine":2,"endColumn":12},{"ruleId":"176","severity":1,"message":"180","line":4,"column":18,"nodeType":"178","messageId":"179","endLine":4,"endColumn":22},{"ruleId":"176","severity":1,"message":"181","line":9,"column":10,"nodeType":"178","messageId":"179","endLine":9,"endColumn":25},{"ruleId":"176","severity":1,"message":"182","line":10,"column":10,"nodeType":"178","messageId":"179","endLine":10,"endColumn":16},{"ruleId":"176","severity":1,"message":"183","line":1,"column":17,"nodeType":"178","messageId":"179","endLine":1,"endColumn":26},{"ruleId":"176","severity":1,"message":"184","line":6,"column":9,"nodeType":"178","messageId":"179","endLine":6,"endColumn":16},{"ruleId":"176","severity":1,"message":"185","line":7,"column":9,"nodeType":"178","messageId":"179","endLine":7,"endColumn":16},{"ruleId":"176","severity":1,"message":"186","line":7,"column":25,"nodeType":"178","messageId":"179","endLine":7,"endColumn":31},{"ruleId":"176","severity":1,"message":"180","line":2,"column":26,"nodeType":"178","messageId":"179","endLine":2,"endColumn":30},{"ruleId":"176","severity":1,"message":"183","line":1,"column":20,"nodeType":"178","messageId":"179","endLine":1,"endColumn":29},{"ruleId":"176","severity":1,"message":"187","line":8,"column":29,"nodeType":"178","messageId":"179","endLine":8,"endColumn":47},{"ruleId":"176","severity":1,"message":"188","line":6,"column":15,"nodeType":"178","messageId":"179","endLine":6,"endColumn":21},{"ruleId":"176","severity":1,"message":"188","line":29,"column":15,"nodeType":"178","messageId":"179","endLine":29,"endColumn":21},{"ruleId":"176","severity":1,"message":"188","line":35,"column":15,"nodeType":"178","messageId":"179","endLine":35,"endColumn":21},{"ruleId":"189","severity":1,"message":"190","line":87,"column":8,"nodeType":"191","endLine":87,"endColumn":21,"suggestions":"192"},{"ruleId":"193","severity":1,"message":"194","line":179,"column":17,"nodeType":"195","endLine":179,"endColumn":60},{"ruleId":"176","severity":1,"message":"196","line":2,"column":30,"nodeType":"178","messageId":"179","endLine":2,"endColumn":35},{"ruleId":"176","severity":1,"message":"197","line":5,"column":27,"nodeType":"178","messageId":"179","endLine":5,"endColumn":44},{"ruleId":"176","severity":1,"message":"198","line":8,"column":8,"nodeType":"178","messageId":"179","endLine":8,"endColumn":14},{"ruleId":"176","severity":1,"message":"199","line":13,"column":12,"nodeType":"178","messageId":"179","endLine":13,"endColumn":22},{"ruleId":"200","severity":1,"message":"201","line":31,"column":35,"nodeType":"202","messageId":"203","endLine":31,"endColumn":37},{"ruleId":"200","severity":1,"message":"201","line":96,"column":24,"nodeType":"202","messageId":"203","endLine":96,"endColumn":26},{"ruleId":"176","severity":1,"message":"204","line":7,"column":10,"nodeType":"178","messageId":"179","endLine":7,"endColumn":31},{"ruleId":"176","severity":1,"message":"205","line":8,"column":10,"nodeType":"178","messageId":"179","endLine":8,"endColumn":21},{"ruleId":"189","severity":1,"message":"206","line":24,"column":8,"nodeType":"191","endLine":24,"endColumn":26,"suggestions":"207"},{"ruleId":"189","severity":1,"message":"208","line":41,"column":8,"nodeType":"191","endLine":41,"endColumn":21,"suggestions":"209"},{"ruleId":"210","severity":1,"message":"211","line":49,"column":17,"nodeType":"195","endLine":49,"endColumn":45},{"ruleId":"176","severity":1,"message":"212","line":139,"column":11,"nodeType":"178","messageId":"179","endLine":139,"endColumn":17},{"ruleId":"189","severity":1,"message":"213","line":46,"column":6,"nodeType":"191","endLine":46,"endColumn":15,"suggestions":"214"},{"ruleId":"189","severity":1,"message":"215","line":54,"column":6,"nodeType":"191","endLine":54,"endColumn":8,"suggestions":"216"},{"ruleId":"176","severity":1,"message":"188","line":35,"column":15,"nodeType":"178","messageId":"179","endLine":35,"endColumn":21},{"ruleId":"176","severity":1,"message":"188","line":41,"column":15,"nodeType":"178","messageId":"179","endLine":41,"endColumn":21},{"ruleId":"200","severity":1,"message":"217","line":10,"column":28,"nodeType":"202","messageId":"218","endLine":10,"endColumn":30},{"ruleId":"176","severity":1,"message":"219","line":1,"column":18,"nodeType":"178","messageId":"179","endLine":1,"endColumn":28},{"ruleId":"176","severity":1,"message":"220","line":8,"column":10,"nodeType":"178","messageId":"179","endLine":8,"endColumn":22},{"ruleId":"176","severity":1,"message":"221","line":65,"column":12,"nodeType":"178","messageId":"179","endLine":65,"endColumn":17},{"ruleId":"176","severity":1,"message":"222","line":2,"column":8,"nodeType":"178","messageId":"179","endLine":2,"endColumn":19},{"ruleId":"176","severity":1,"message":"223","line":9,"column":12,"nodeType":"178","messageId":"179","endLine":9,"endColumn":17},{"ruleId":"176","severity":1,"message":"224","line":9,"column":19,"nodeType":"178","messageId":"179","endLine":9,"endColumn":27},{"ruleId":"176","severity":1,"message":"223","line":13,"column":12,"nodeType":"178","messageId":"179","endLine":13,"endColumn":17},{"ruleId":"176","severity":1,"message":"224","line":13,"column":19,"nodeType":"178","messageId":"179","endLine":13,"endColumn":27},{"ruleId":"200","severity":1,"message":"201","line":6,"column":27,"nodeType":"202","messageId":"203","endLine":6,"endColumn":29},{"ruleId":"200","severity":1,"message":"201","line":8,"column":45,"nodeType":"202","messageId":"203","endLine":8,"endColumn":47},{"ruleId":"200","severity":1,"message":"201","line":28,"column":27,"nodeType":"202","messageId":"203","endLine":28,"endColumn":29},{"ruleId":"200","severity":1,"message":"201","line":32,"column":45,"nodeType":"202","messageId":"203","endLine":32,"endColumn":47},{"ruleId":"200","severity":1,"message":"201","line":60,"column":25,"nodeType":"202","messageId":"203","endLine":60,"endColumn":27},{"ruleId":"200","severity":1,"message":"201","line":62,"column":22,"nodeType":"202","messageId":"203","endLine":62,"endColumn":24},{"ruleId":"200","severity":1,"message":"201","line":82,"column":29,"nodeType":"202","messageId":"203","endLine":82,"endColumn":31},{"ruleId":"200","severity":1,"message":"201","line":88,"column":43,"nodeType":"202","messageId":"203","endLine":88,"endColumn":45},{"ruleId":"200","severity":1,"message":"201","line":92,"column":27,"nodeType":"202","messageId":"203","endLine":92,"endColumn":29},{"ruleId":"200","severity":1,"message":"201","line":98,"column":32,"nodeType":"202","messageId":"203","endLine":98,"endColumn":34},{"ruleId":"200","severity":1,"message":"201","line":106,"column":58,"nodeType":"202","messageId":"203","endLine":106,"endColumn":60},{"ruleId":"176","severity":1,"message":"225","line":9,"column":15,"nodeType":"178","messageId":"179","endLine":9,"endColumn":19},"no-native-reassign",["226"],"no-negated-in-lhs",["227"],"@typescript-eslint/no-unused-vars","'logo' is defined but never used.","Identifier","unusedVar","'Menu' is defined but never used.","'HeaderComponent' is defined but never used.","'Footer' is defined but never used.","'useEffect' is defined but never used.","'SubMenu' is assigned a value but never used.","'Content' is assigned a value but never used.","'Header' is assigned a value but never used.","'setShowHaveAccount' is assigned a value but never used.","'result' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'dataSource.firstname' and 'dataSource.lastname'. Either include them or remove the dependency array.","ArrayExpression",["228"],"jsx-a11y/alt-text","img elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","JSXOpeningElement","'Input' is defined but never used.","'salaryMonthColumn' is defined but never used.","'moment' is defined but never used.","'getKeyDown' is assigned a value but never used.","array-callback-return","Array.prototype.map() expects a return value from arrow function.","ArrowFunctionExpression","expectedInside","'TablePaginationConfig' is defined but never used.","'EmployeeApi' is defined but never used.","React Hook useEffect has a missing dependency: 'handleAdd'. Either include it or remove the dependency array.",["229"],"React Hook useEffect has missing dependencies: 'handleOperation' and 'props'. Either include them or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.",["230"],"jsx-a11y/anchor-is-valid","The href attribute is required for an anchor to be keyboard accessible. Provide a valid, navigable address as the href value. If you cannot provide an href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/evcohen/eslint-plugin-jsx-a11y/blob/master/docs/rules/anchor-is-valid.md","'AddBtn' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'inputRef'. Either include it or remove the dependency array.",["231"],"React Hook useEffect has a missing dependency: 'dataIndex'. Either include it or remove the dependency array.",["232"],"Array.prototype.map() expects a value to be returned at the end of arrow function.","expectedAtEnd","'Popconfirm' is defined but never used.","'EditableCell' is defined but never used.","'count' is assigned a value but never used.","'html2canvas' is defined but never used.","'ready' is assigned a value but never used.","'setReady' is assigned a value but never used.","'show' is assigned a value but never used.","no-global-assign","no-unsafe-negation",{"desc":"233","fix":"234"},{"desc":"235","fix":"236"},{"desc":"237","fix":"238"},{"desc":"239","fix":"240"},{"desc":"241","fix":"242"},"Update the dependencies array to be: [dataSource.firstname, dataSource.lastname, reportMonth]",{"range":"243","text":"244"},"Update the dependencies array to be: [handleAdd, props.checkEnter]",{"range":"245","text":"246"},"Update the dependencies array to be: [dataSources, handleOperation, props]",{"range":"247","text":"248"},"Update the dependencies array to be: [editing, inputRef]",{"range":"249","text":"250"},"Update the dependencies array to be: [dataIndex]",{"range":"251","text":"252"},[3702,3715],"[dataSource.firstname, dataSource.lastname, reportMonth]",[712,730],"[handleAdd, props.checkEnter]",[1179,1192],"[dataSources, handleOperation, props]",[1279,1288],"[editing, inputRef]",[1456,1458],"[dataIndex]"]